{% extends 'base.html' %}
{% block title %}借阅记录{% endblock %}
{% block content %}
<section class="card stack">
  <h2>借阅记录</h2>
  <div class="table-wrapper">
    <table class="table">
      <thead>
        <tr><th>ID</th><th>用户</th><th>图书</th><th>借出</th><th>到期</th><th>归还</th><th>操作</th></tr>
      </thead>
      <tbody>
        {% for r in rows %}
          <tr>
            <td>{{ r.borrow_id }}</td>
            <td>{{ r.username }}</td>
            <td>{{ r.title }}</td>
            <td>{{ r.borrowed_at }}</td>
            <td>{{ r.due_at }}</td>
            <td>{{ r.returned_at or '-' }}</td>
            <td>
              {% if not r.returned_at %}
                <div class="table-actions">
                  <a href="{{ url_for('return_book', borrow_id=r.borrow_id) }}" class="btn btn-primary">归还</a>
                </div>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="table-footer">
    <span>共 {{ total }} 条记录</span>
    {% if pages > 1 %}
    <nav class="pagination">
      {% if has_prev %}
        <a href="{{ url_for('borrows', page=page-1) }}" class="btn btn-ghost">上一页</a>
      {% else %}
        <span class="btn btn-ghost disabled">上一页</span>
      {% endif %}
      <span>第 {{ page }} / {{ pages }} 页</span>
      {% if has_next %}
        <a href="{{ url_for('borrows', page=page+1) }}" class="btn btn-ghost">下一页</a>
      {% else %}
        <span class="btn btn-ghost disabled">下一页</span>
      {% endif %}
    </nav>
    {% endif %}
  </div>
</section>
{% endblock %}