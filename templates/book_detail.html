{% extends 'base.html' %}
{% block title %}书籍详情{% endblock %}
{% block content %}
<section class="card stack">
  <h2>{{ book.title }}</h2>
  <div class="meta-grid">
    <div class="meta-item">
      <span class="meta-label">作者</span>
      <span class="meta-value">{{ book.author_name or '-' }}</span>
    </div>
    <div class="meta-item">
      <span class="meta-label">分类</span>
      <span class="meta-value">{{ book.category_name or '-' }}</span>
    </div>
    <div class="meta-item">
      <span class="meta-label">ISBN</span>
      <span class="meta-value">{{ book.isbn or '-' }}</span>
    </div>
    <div class="meta-item">
      <span class="meta-label">库存</span>
      <span class="meta-value">{{ book.stock }}</span>
    </div>
  </div>
</section>

<section class="card stack">
  <h3>借阅</h3>
  <form method="post" action="{{ url_for('borrow_book', book_id=book.book_id) }}" class="form-grid">
    <div class="form-group">
      <label for="borrow-user">用户ID</label>
      <input id="borrow-user" name="user_id" placeholder="输入用户ID">
    </div>
    <div class="form-group">
      <label for="borrow-days">借阅天数</label>
      <input id="borrow-days" name="days" type="number" min="1" max="60" value="14">
    </div>
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">借阅</button>
      <a href="{{ url_for('users') }}" class="btn btn-ghost">管理用户</a>
    </div>
  </form>
  <p class="hint">没有账号？前往用户页面创建后再借阅。</p>
</section>

<section class="card stack">
  <h3>书评</h3>
  <form method="post" action="{{ url_for('add_review', book_id=book.book_id) }}" class="form-grid">
    <div class="form-group">
      <label for="review-user">用户ID</label>
      <input id="review-user" name="user_id" placeholder="输入用户ID">
    </div>
    <div class="form-group">
      <label for="review-rating">评分</label>
      <input id="review-rating" name="rating" type="number" min="1" max="5" value="5">
    </div>
    <div class="form-group">
      <label for="review-content">评价内容</label>
      <input id="review-content" name="content" placeholder="留下你的评价">
    </div>
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">提交评价</button>
    </div>
  </form>
  <ul class="reviews">
    {% for r in reviews %}
      <li>
        <strong>{{ r.username }}</strong>（{{ r.created_at }}）
        <div class="hint">评分 {{ r.rating }}</div>
        <div>{{ r.content or '' }}</div>
      </li>
    {% endfor %}
  </ul>
</section>
{% endblock %}